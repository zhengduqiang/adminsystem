<html class="no-js" xmlns:fm="http://www.w3.org/1999/html">
<html xmlns="http://www.w3.org/1999/xhtml">
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=emulateIE7"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="common/css/sapar.css"/>
    <link rel="stylesheet" href="common/css2/index.css"/>
    <link rel="icon" href="common/images2/logo.jpg" type="image/x-icon"/>
    <link rel="stylesheet" href="common/css2/index_inner.css"/>
    <link rel="stylesheet" type="text/css" href="common/css/common.css"/>
    <link rel="stylesheet" type="text/css" href="ticket/css/my_order.css"/>
    <script type="text/javascript" src="common/js/WdatePicker.js"></script>
    <title>新澳森校油泵管理系统</title>
</head>
<body>
<div id="container">
    <div id="hd">
        <div class="hd-wrap clearfix">
            <div class="top-light"></div>
            <ul class="main-nav clearfix" style="height: 0px;margin-left: 5px;">
                <li class="current" data-src="static/ticket/index.html"><a th:href="@{/findFinancingAll}">账本</a></li>
                <li data-src="static/caiwu/index.html"><a th:href="@{/findInventoryAll}">库存</a></li>
                <li data-src="static/msg/index.html"><a th:href="@{/findSupplierAll}">供应商</a></li>
                <li data-src="static/insurance/index.html"><a th:href="@{/findSalaryAll}">工资</a></li>
            </ul>
            <div style="float:left">
                <img src="common/images/logo1.png" height="100" width="300" style="margin-left: 80px;"/>
            </div>
            <div class="toolbar">
                <div class="login-info clearfix">
                    <div class="welcome clearfix"><span>欢迎您,</span><a href="javascript:;" class="user-name">管理员</a>
                    </div>
                </div>
                <div class="tool clearfix" style="margin-left: 95px;">
                    <a href="javascript:;" class="quit-btn exit">退出</a>
                </div>
            </div>
        </div>
    </div>
    <div id="bd">
        <div class="wrap clearfix">
            <div class="sidebar" style="background-color: #f1f8fc">
                <h2 class="sidebar-header"><p>功能导航</p></h2>
                <ul class="nav">
                    <li class="office current">
                        <div class="nav-header"><a th:href="@{/findFinancingAll}" data-src="buy_msg.html"
                                                   class="clearfix"><span>账本管理</span><i
                                class="icon"></i></a></div>
                    </li>
                    <li class="gongwen ">
                        <div class="nav-header"><a th:href="@{/group_ticket_apply}" data-src="send_msg.html"
                                                   class="clearfix"><span>添加账本</span><i
                                class="icon"></i></a></div>
                    </li>
                </ul>
            </div>
            <div class="content">
                <div class="topbar clearfix">
                    <div id="saper-container">
                        <div id="saper-hd"></div>
                        <div id="saper-bd">
                            <div class="subfiled clearfix">
                                <h2>账本信息</h2>
                            </div>
                            <div class="subfiled-content">
                                <form name="f1" id="f1" th:action="findFinancingAll"
                                      method="post">
                                    <div class="search-box clearfix">
                                        <div class="kv-item clearfix">
                                            <label>车牌号：</label>
                                            <div class="kv-item-content">
                                                <input type="text" th:value="${PlateNum}" placeholder="车牌号"
                                                       name="PlateNum"/>
                                            </div>
                                        </div>
                                        <div class="kv-item clearfix">
                                            <label>维修负责人：</label>
                                            <div class="kv-item-content">
                                                <input type="text" name="maintainPrincipal"
                                                       th:value="${maintainPrincipal}" placeholder="维修负责人"/>
                                            </div>
                                        </div>
                                        <div class="kv-item clearfix">
                                            <label>欠账负责人：</label>
                                            <div class="kv-item-content">
                                                <input type="text" name="billsDueObligor"
                                                       th:value="${billsDueObligor}" placeholder="欠账负责人"/>
                                            </div>
                                        </div>
                                        <div class="kv-item clearfix">
                                            <label>支付方式：</label>
                                            <div class="kv-item-content">
                                                <select name="payWay">
                                                    <option value="" th:selected="${payWay==''}">全部</option>
                                                    <option value="现金" th:selected="${payWay=='现金'}">现金</option>
                                                    <option value="支付宝" th:selected="${payWay=='支付宝'}">支付宝</option>
                                                    <option value="微信" th:selected="${payWay=='微信'}">微信</option>
                                                    <option value="欠账" th:selected="${payWay=='欠账'}">欠账</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="kv-item clearfix">
                                            <label>维修日期：</label>
                                            <div class="kv-item-content time-select-wrap">
                                                <div class="time-select">
                                                    <input type="text" onfocus="WdatePicker({dateFmt:'yyyy-MM-dd'})"
                                                           placeholder="" name="maintainDate"
                                                           th:value="${maintainDate}"/>
                                                    <i class="date-icon"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <input type="submit" class="sapar-btn sapar-btn-recom query-btn" value="查询"/>
                                    </div>
                                </form>
                                <!--表格开始-->
                                <div class="table">
                                    <!--表格具体内容-->
                                    <div class="table-box">
                                        <table style="font-size: 12px;">
                                            <thead>
                                            <tr>
                                                <th>车牌号</th>
                                                <th>维修日期</th>
                                                <th>维修项目</th>
                                                <th>维修项目价格</th>
                                                <th>支付方式</th>
                                                <th>维修负责人</th>
                                                <th>欠账负责人</th>
                                                <th>操作</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="financingAll:${financingAlls}">
                                                <td><a class="blue bold" href="javascript:;"
                                                       th:text="${financingAll.PlateNum}">141212297794</a></td>
                                                <td>
                                                    <p th:text="${financingAll.maintainDate}" class="rq">
                                                        2019-03-04 13:16</p></td>
                                                <td th:text="${financingAll.maintenanceItems}">维修了一个油泵，大号单套的</td>
                                                <td><p th:text="'￥'+${financingAll.itemsMoney}" class="orange bold">
                                                    ¥1060.0</p></td>
                                                <td th:text="${financingAll.payWay}">微信</td>
                                                <td th:text="${financingAll.maintainPrincipal}">小杜</td>
                                                <td th:text="${financingAll.billsDueObligor}">无欠款</td>
                                                <td>
                                                    <input type="hidden" th:value="${financingAll.fId}"/>
                                                    <a href="javascript:;" class="xg">[修改]</a></td>
                                            </tr>
                                            <tr class="no-data" th:if="${pageInfo.total==0}">
                                                <td colspan="10">没有查询到任何数据</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <div class="container large" th:if="${pageInfo.total>12}"
                                             style="position:absolute;left:680px;top:580px;height: 10px;">
                                            <p style="color: #7d7d7d;text-transform: uppercase;font-size:14px;position:relative;left:-220px;">
                                                共<span th:text="${pageInfo.total}"></span>条记录 每页<span
                                                    th:text="${pageInfo.pageSize}"></span>条 现在<span
                                                    th:text="${pageInfo.pageNum}"></span>/<span
                                                    th:text="${pageInfo.pages}"></span>页</p>
                                            <div class="pagination">
                                                <ul>
                                                    <li>
                                                        <a th:href="@{/findFinancingAll(pageNum=1,PlateNum=${PlateNum},maintainPrincipal=${maintainPrincipal},payWay=${payWay},maintainDate=${maintainDate})}">首页</a>
                                                    </li>
                                                    <li th:if="${pageInfo.pageNum!=1}">
                                                        <a th:href="@{/findFinancingAll(pageNum=${pageInfo.pageNum-1},PlateNum=${PlateNum},maintainPrincipal=${maintainPrincipal},payWay=${payWay},maintainDate=${maintainDate})}">上一页</a>
                                                    </li>
                                                    <li th:if="${pageInfo.pageNum==1}">
                                                        <a th:href="@{/findFinancingAll(pageNum=${pageInfo.pageNum},PlateNum=${PlateNum},maintainPrincipal=${maintainPrincipal},payWay=${payWay},maintainDate=${maintainDate})}">上一页</a>
                                                    </li>
                                                    <li th:if="${pageInfo.pageNum<pageInfo.pages}">
                                                        <a th:href="@{/findFinancingAll(pageNum=${pageInfo.pageNum+1},PlateNum=${PlateNum}
                                                        ,maintainPrincipal=${maintainPrincipal},payWay=${payWay},maintainDate=${maintainDate})}">下一页</a>
                                                    </li>
                                                    <li th:if="${pageInfo.pageNum==pageInfo.pages}">
                                                        <a th:href="@{/findFinancingAll(pageNum=${pageInfo.pageNum},PlateNum=${PlateNum}
                                                        ,maintainPrincipal=${maintainPrincipal},payWay=${payWay},maintainDate=${maintainDate})}">下一页</a>
                                                    </li>
                                                    <li>
                                                        <a th:href="@{/findFinancingAll(pageNum=${pageInfo.pages},PlateNum=${PlateNum},maintainPrincipal=${maintainPrincipal},payWay=${payWay},maintainDate=${maintainDate})}">尾页</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>

                                    </div>
                                </div><!--表格结束-->
                            </div>
                        </div>
                        <div id="saper-ft"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div id="ft" class="clearfix">
        <div class="ft-left">
            <span>新澳森校油泵管理系统</span>
            <em>Office&nbsp;System</em>
        </div>
        <div class="ft-right">
            <span>Automation</span>
            <em>V2.0&nbsp;2014</em>
        </div>
    </div>
</div>
<!-- 温馨提示 -->
<div class="exitDialog2">
    <div class="dialog-content">
        <div class="ui-dialog-text" style="background-color:ActiveBorder;width: 200px;">
            <p class="dialog-content">我的温馨提示</p>
        </div>
    </div>
</div>
<!-- 对话框 -->
<div class="exitDialog">
    <div class="dialog-content">
        <div class="ui-dialog-icon">
        </div>
        <div class="ui-dialog-text">
            <p class="dialog-content">你确定要退出系统？</p>
            <p class="tips">如果是请点击“确定”，否则点“取消”</p>
            <div class="buttons">
                <button type="button" class="layui-btn layui-btn-normal qdtcxt" style="background-color: #1E9FFF;
                    padding: 7px 18px 7px 18px;border: 0px;font-size:14px;color:white;border-radius:5%;">
                    确定
                </button>
                <button type="button" class="xtqx" style="background-color: #FF5722;
                    padding: 7px 18px 7px 18px;border: 0px;font-size:14px;color:white;border-radius:5%;margin-left: 10px;">
                    取消
                </button>
            </div>
        </div>
    </div>
</div>

<div class="exitDialog4">
    <div class="dialog-content">
        <div class="ui-dialog-icon">
        </div>
        <div class="ui-dialog-text">
            <p class="dialog-content">是否修改账本信息？</p>
            <p class="tips">如果是请点击“确定”，否则点“取消”</p>
            <div class="buttons">
                <button type="button" class="layui-btn layui-btn-normal " style="background-color: #1E9FFF;
                    padding: 7px 18px 7px 18px;border: 0px;font-size:14px;color:white;border-radius:5%;" id="qdxg">
                    确定
                </button>
                <button type="button" class="xtqx" style="background-color: #FF5722;
                    padding: 7px 18px 7px 18px;border: 0px;font-size:14px;color:white;border-radius:5%;margin-left: 10px;">
                    取消
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 修改对话框 -->
<div id="xg"
     style="background-color: rgba(0,0,0,0.8);width:100%;height:100%;position:absolute;top:-50px;z-index:999;display:none; ">
    <div
            style="background-color:white;width:500px; height: 600px; margin-left:500px;margin-top:100px; border-radius: 5%;">
        <div class="subfiled clearfix" style="border-radius: 5%;">
            <h2 style="margin-left: 140px;font-size:19px;">修改账本信息</h2>
        </div>
        <div style="margin-left: 80px;">
            <br/>
            <br/>
            <br/>
            <input type="hidden" id="fid" placeholder="车牌号" style="width: 150px;"/>
            <form class="passenger-info">
                <div class="kv-item2 clearfix">
                    <label style="font-size: 13px;">车牌号：</label>
                    <div class="kv-item-content">
                        <input type="text" id="cph" placeholder="车牌号" style="width: 150px;"/>
                    </div>
                    <div class="kv-item-tip"></div>
                </div>
                <div class="kv-item2 clearfix">
                    <label style="font-size: 13px;">维修项目：</label>
                    <div class="kv-item-content">
                        <textarea style="margin-top:5px;" class="maintenanceItems"></textarea>
                    </div>
                    <div class="kv-item-tip"></div>
                </div>
                <div class="kv-item2 clearfix">
                    <label style="font-size: 13px;">维修价格：</label>
                    <div class="kv-item-content">
                        <input type="text" placeholder="维修价格" class="itemsMoney" style="width: 150px;" maxlength="8"
                               onkeyup="this.value=this.value.replace(/[^0-9]/g,'')"/>
                    </div>
                    <div class="kv-item-tip"></div>
                </div>
                <div class="kv-item2 clearfix">
                    <label style="font-size: 13px;">维修负责人：</label>
                    <div class="kv-item-content">
                        <input type="text" placeholder="维修负责人" class="maintainPrincipal" style="width: 150px;"/>
                    </div>
                    <div class="kv-item-tip"></div>
                </div>
                <div class="kv-item2 clearfix">
                    <label style="font-size: 13px;">欠账负责人：</label>
                    <div class="kv-item-content">
                        <input type="text" placeholder="欠账负责人" class="billsDueObligor" style="width: 150px;"/>
                    </div>
                    <div class="kv-item-tip"></div>
                </div>
                <div class="kv-item2 clearfix">
                    <label style="padding-left: 12px;">维修日期：</label>
                    <div class="kv-item-content time-select-wrap">
                        <div class="time-select">
                            <input type="text" onfocus="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm'})" style="width: 160px;"
                                   placeholder="" class="maintainDate"/>
                            <i class="date-icon"></i>
                        </div>
                    </div>
                </div>
                <div class="kv-item2 clearfix">
                    <label style="font-size: 13px;">支付方式：</label>
                    <div class="kv-item-content">
                        <select class="payWay">
                            <option>现金</option>
                            <option>支付宝</option>
                            <option>微信</option>
                            <option>欠账</option>
                        </select>
                    </div>
                    <br/>
                    <br/>
                    <br/>
                    <div class="buttons clearfix" style="margin-left: 60px;">
                        <a href="javascript:;" class="sapar-btn sapar-btn-recom exit4">修改</a>
                        <a href="javascript:;" id="qx" class="sapar-btn sapar-btn-recom"
                           style="margin-left: 20px;">取消</a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="common/js/jquery.js"></script>
<script type="text/javascript" src="common/js/sapar.js"></script>
<script type="text/javascript" src="common/js2/index.js"></script>
<!--<script src="common/layui/layui.js"></script>-->
<script>
    //按照ID查询账本信息
    $(".xg").click(function () {
        $("#xg").css("display", "block");
        var id = $(this).prev("input").val();
        $.ajax({
            url: "/findFinancingId",
            type: "post",
            data: {fId: id},
            dataType: "json",
            success: function (result) {
                if (result.payWay == '微信') {
                    $(".payWay").val("微信");
                } else if (result.payWay == '支付宝') {
                    $(".payWay").val("支付宝");
                } else if (result.payWay == '现金') {
                    $(".payWay").val("现金");
                } else if (result.payWay == '欠账') {
                    $(".payWay").val("欠账");
                }
                $(".maintainDate").val(result.maintainDate);
                $("#cph").val(result.plateNum);
                $(".maintenanceItems").val(result.maintenanceItems);
                $(".maintainPrincipal").val(result.maintainPrincipal);
                $(".billsDueObligor").val(result.billsDueObligor);
                $(".itemsMoney").val(result.itemsMoney);
                $("#fid").val(result.fId);
                console.log(result);
            },
            error: function () {
                alert("出现异常，请刷新重试");
            }
        })
    });
    //修改账本信息
    $("#qdxg").click(function () {
        var payWay2 = $(".payWay").val();
        var maintainDate2 = $(".maintainDate").val();
        var plateNum2 = $("#cph").val();
        var fid2 = $("#fid").val();
        var maintenanceItems2 = $(".maintenanceItems").val();
        var maintainPrincipal2 = $(".maintainPrincipal").val();
        var billsDueObligor2 = $(".billsDueObligor").val();
        var itemsMoney2 = $(".itemsMoney").val();
        $.ajax({
            url: "/updateFinancingId",
            type: "post",
            data: {
                fId: fid2,
                payWay: payWay2,
                maintainDate: maintainDate2,
                maintenanceItems: maintenanceItems2,
                maintainPrincipal: maintainPrincipal2,
                billsDueObligor: billsDueObligor2,
                itemsMoney: itemsMoney2,
                plateNum: plateNum2
            },
            dataType: "json",
            success: function (result) {
                if (result == 1) {
                    alert("修改账本信息成功");
                    window.location.reload();
                }
            },
            error: function () {
                alert("出现异常，请确定文本框内容输入正确或刷新当前页面");
            }
        })
    });


    $("#qx").click(function () {
        $("#xg").css("display", "none");
    });

    $('.exitDialog4').Dialog({
        title: '温馨提示',
        autoOpen: false,
        width: 400,
        height: 200
    });

    $('.exit4').click(function () {
        $('.exitDialog4').Dialog('open');
    });
    $("#xt").click(function () {
        $('.exitDialog4').Dialog('close');
    });
    $(".xtqx").click(function () {
        $('.exitDialog4').Dialog('close');
        $('.exitDialog').Dialog('close');
    });
    $(".qdtcxt").click(function () {
        window.location.href = "/exitLogin";
    });

</script>
</html>
